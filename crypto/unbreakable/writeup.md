# Writeup - Unbreakable cipher

We are getting long text of gibberish and a decoding function. We see that
the decoding function requires some kind of `key` and an `alphabet`, so
the cipher looks like a 
[polyalphabetic cipher](https://en.wikipedia.org/wiki/Polyalphabetic_cipher).

First, we need the alphabet. It looks like there's only letters in the cipher text, so we guess 
that it's the English alphabet, all lower case.
```
abcdefghijklmnopqrstuvwxyz
```

Now that we have the alphabet, we have to find the keyword. Since this is a polyalphabetic cipher, we try [Kasiski examination](https://en.wikipedia.org/wiki/Kasiski_examination):
```bash
> python3 kasiski.py
eau   1
eau   229
eau   547
```

Find GCD of `595-1` and `739-595`:
```bash
> python3 egcd.py
(6, 7, -5)
```
The greatest common divisor is 6. We will then try to split the cipher text into 6 subtexts, where
the 6 first characters are in different subtexts, the 7th character is in the first subtext, the
8th is in the second, and so on:
```bash
> python3 split.py
eseeseshkseesehseskkkesskhksesssssekhkeeseeesseksssksskksskksesseskskssshskkskeekehesekksskeksksesksssseheehkekessssskseeskekekskkksseekssheeekeeeeekkskhkeseeesshesskeesshskeskhseekeseskskkekesskssskeskehkksskkeksksesesekkkeekkseesskeekssesseeskkkseekkhskssksekeskeseeseeekkhkeekskssssskkksssessssseeskkseesesesseeksskeshkekkskeehkskskessskkskkkkekksseeskekkksksskessskkeeeekeshkekeseeskkkeheeekesehssssksehkekkeessssskshsskskekeekeeskehesskkkekkssekskkekeksesskkseksskeskkeesssehssekshssseseekskeeekskksskksskeskkkssskekeeseessssseskkseseeeskksssehkeehkskkesekkekksehskeksskseseeksesekssskeksseksekeehssekskeeksekekeskkkssskekeeseessssseskkseseeeskksssehkssksesehksksskssskssksskkseesesskekskseskhesheeskkkeekseksksesssssskssskksekkeksseseeekksehssehesksseeseekssskseksseskkkeskesksskesskeshssekkeesskesshkehkeekseeesskskehkkhsesksesskkessssskssssekkeskskhkksessekksskssskskseeseekksksskehekkkssesskkssksesssesekkkksseekeekeskkssskskeekekseeeskesekskkesessessskekkekeesekssskkeeekskeesshekkekseseekssesskskseeesskkksskesekseeekskssskekkksseeeeekskkseeksekhkeksksksssskksesekeessssekkkeekeekekssksekkksksesskeehksseksseeeessshksssehkksekkeeekesekeskekkessekssksesskessseekesssehkessssesekseskeseskksekkssseeeseeeesseeessssskskess
aaogooggogoooogggooaogogagooaaogaogogaaogogogagdgaoaagdaggdoagaagaoooooggaodgaaooogaagdoggoaoadgaaaggooggoogogoogaaaoaooggogaadgdooagaoogoggooaagaaoaoaogooooagagggagaaogggaoogdgooaagoooaadaaaoaaoaagoogoogoaagoagdgagogogoooogooogogoaaoaaggogoogadaaggaaagaaggagooooaogoooaagoogoogoadgagaooooogoaaogaogggooogagaaoaaoooooaoggoaoaaaoggoooadggoaoaaooodooogoaggoadoogogadggoaoaoogoooggogoaaoaaaoaoggooagogggooaoaogaoodagoggagoggaoagaadooaoaoooggagodogooagooooogagoooaaodgoogadooadagggaoggaoaggoagogggaaogagoaoagaodgaogoadaoagaaoogagaagaggagooagooooaoaogaogaoagogoaoaoododooagooadgaoagaoooooooaaooooooaoogoaoggoooogooodgoaaogoadaoagaaoogagaagaggagooagooooaoaogaogoogoagoogoaaagoggaaaaagaodgoaooagdodgaaooogagggogaoogoaoooaoggggaoaoaaggooagooaoogaaaogodgoggaogggoogagoogaoggaoaogogooodggoaaagaagaaoaogggooagoagoggggaogagooagoaooogoogoaggagoagoaooggoagodaogogdogaaaogooaaooaaagadgaaooaoooagodaoaggoogaodaaogooodgadgagoggoadoaagaaoogaoooodgoooaooooaaagogooagooodoaaogaaggoaaoogaagooaooaaogggaaogooggaoogoaooogaoooaoaooogggogodaggogogdgagoaoagoaoaoodgoogoogoaooggoagadgoadgogdgooadogggadagoggoaooaagooaaadaaagoaaaaoooogagggoogoogoagaggaggooggogodggaaaooagoadggoooaogoaaaaaagoaoagoooaaggooggagoaaoagoooooaoooooooaoaoogaagaaaoogaaooogogaaoaoag
uccruucooccuuccrcucoucuoccuccuucuccoooucrurucccuooocucuoooucccuccuucoocccuuuccouccccucuoooouccuooourccuccuoooccuoocuucuoccorouucuocoouucouocoocoouuuoocooccuocccccocruuccocucuououoocruocccuouuuccoooooucuocuucouorucorucuruccoruooccocccoucrocouuccucorccccocccrcruouucoruuucoccoccococucuccuooococcuucucorocouooccuouoououuouccouccccococuocuccuuccucuuuucoouucoooucoocccuccuuccccccoucoocuoccucccooocooccuccoccuucccouuuoouccucoccuccrouuuooucuoococrouucucuruoucorccuuuoccucuuccuocouocrouorccuocccucurccouuoucocccccuuocoruouoourouuoccoucoorocccccocououccccoocouccocuuuocouuucucooocucccuoccucuccuouucououooococuocucoorcuuucuouoruouoourouuoccoucoorocccccocououccccoocuuooooocccuocrooocccucccuucuuccuouuuccouucoococcrucoruouucucccrcuccocucrccuocucoucuoucocucorcuoccrcucooucoccorcouocccccuurcucourccoccoouocccuoruccurccooucoruouruccucccococcrccourucoocruccuuuoccouocccuoccuocuucooccucucuuouuocouuoccrccooucuoououuuuocuocruccuuuccoouuuorucuuouccoouccocuuccuooooooouucouccucccucucoocoouucuccuorccouuouucouuoroocccocuuuoooocurccucuuoooorcouoorucoccccoucuucuuruucoccccccoccuoooucccuccucuorcocuooucccuccooroucuouoourucuouccoccorcooucuooucoccrccocuooooouococuooocccurcuuoccouuocccccccccoocouorccuccoocuococucccocuuooocucocououcccuuourucuuuooccoccoco
iiaaiuiiaiaiuuiaauaiuiiuauuauiiuxauiiuiaaiaiiaauuauuiiuuiiuuauxauuxaiaauuuiiauauiuiuiuuaiiuuuuuuaaiauaiiauiiauaiuaaxiixauuiauuuuuaiauxiuauauauuauxiuaiiaiuaiaaiaiiaaaxiaiuaiauiiuuaaaaiuaauiuiixaiiaiiaiuiaiiiiuiiauuuaiiiaiiaiaiaiaauaauiuaauiixiiuuauauaauuaaaaaaiixiuaaiuuaauiauiaaiuuuiiauuiaaiauiiuxauauuaxuaauiiuaiuuxuiiiiiuiuauaiiiiuuiauuiaauiuiiuiuaxiauiauiiiiiuiauuiaaiaaiiiiiauxaiaxaaaiiauauiiuiauaaiiiuiuiiuaiiiaiuiiuiaaauuuiiuxauuiiaaaiiiiiiuauaxiiaaixuiaaauuiiiuiaaiuaaauuiauauuiuiuuuaiiuixuxuuiiiuaiuuaiauuiiaiauixauauxauaauaiiuauaiiiiiuiuiiiuiaiaiiiuaiaiuiaiaiauiuiiaiuaiiiiaaiuuxaiuuuaiiuuiiiuuaaiauiiiuiuiiauuiiaiauixauauxauaauaiiuauaiiiiiuiuiiiixiaauiuuuiaaaaiauiiiiuaiiiiuaiuuiuuaaiiiaiaiiiaaxiiauaiiiiiiaauuaauiiaaiiuiaxaiiauaiaiaiuiauiiaaauiuauxaiuiiaaiiaaiuuiiiaiiaaiaauuauuauiaaiiiaiauuauaiuuuiauiuaiaauiuiiuaiiaauiuaiiiiiaiaaiuuaaiiiaauuuauaiiaixaiuiuiuiaxuixiiauiiuaaauiiuiiiuaiixiiuuaiuaaiuuxiuauuixiuiauixiiuaauuiiauiixauxauuaiuuuiiaiauxauuiiuiiiuaixuiuaaiiaiiuixaiiiuiiiauiaaaiuxuiauiaaxaiuuiiuuiiiaiiiuaaiuaiuauiuiiuaiuaiiuuiiuuiaiuiiuiauiauiaauuuaaiiiuaiiiaiiiiaaaiiaiauaaiaiiiuuiaiauiauiauuiuaxauaiaaiiiuiiiiaiuuuiuauaiaiiauxiaaiixuuauiaiaiiauaaiiiauaiiuiaauaaauiiaaiaiiaiiaiiiiauuxauaiiauaiaiiiuaauiauauu
msaasaaaaspssmsaaamsmmmsmmapsmmasaaaassammmasmmammsammasmmasmasmamsasamaaaamaamasmassamaassmaaampaaasmaamsmmaaammapssssasammsmasaasaasmspaaaasamasaaaasmasampmmmamaaassmsamaamsmmapamamsaaamsassasspssamampmmasamaamasmasmassmmamaspmapaasmaamsssmaamasmaaaamamaamaassaaammaapaasmssaaaaasmsamsspaapsmmasmmaasasmapsmsmpsmssmsaamsmsaaaaamamaaamaamapssamsmssasmasammssmaaaamaamapsapssaammasasmsammsmaaasssaamapmamsmasaammsaspmmaaaaammsmsmsssamsmmaaasmmammaamassmapassmpamasmmaampasmaammsmasmmsaasasammasasasmassaaaaammmamsamammsasasmasamammmssamapsasssasasmmsmaaaaasmpsmmaaamaamamamsammpsasspamsssasmsmpsaasssamspaaassaasmsamamsamammsasasmasamammmssamapsasssasasmmssspmmsmsamaamamasassaaaamssapsmamaaapsmmaamassaassmmmmasammaaamsamsamaasaaamsasmmmpsmsmasmassmaamsaamssamassapsmmpsassmmaaspaamaamasmaaaapsaaamaaaammmsasaamsaaapammasmamasammaammssssmmaaamaapsmmmasasmmmmsassassaamaaasmssmsmmamsaaassmsasasmsssmsammamaamsssmmmssssaamamasssaamsamsassssmasmsaamsamaaasaasasassmssmamssmaapaammmasaspmmasmmmaasapamsssmmsmaasmaaaaaasmmmpsmammmaamaaassmsmaasaaasmassaasaaammsamaaammmpaammasammmsaspsmssaaasaaammpaaassmsmapsamamammasssasasmsmaamaamsmaammsssaasmmammmssmapsssmsasaaaassammpsmaasmaassapmpmasssapsmsmpssaassammasaapsmpaaaassamaassaaasm
dldllldllldlxdxxxllaldxldlddldlxxlldllllldllxllxdxadlllxdxlxlxlxdllxlddddxlxxdlxxddllllxdaxxdxxddllxxlddlldllllldddlllxllllxxxxxllxllxlxddlddadxlldlldadllxldxdldddlxlllxdxxxdxddddllldxldxlxllxdlxdllxxlldlldlllxxdlxlllxxxallxllldxddxdxxlxdlllddxxlxxdxlddxxlxlxxlxxdllddddxladaxlxdxxlllxxladdddldlxlxdlxlxxdldldxldlxlxxxddlxladldddldldxldddlxdalllxlallldxldlxxllddxldddlxdlldllddldlldllxxllldlddallxdxddxxdxdlllldxllxdxlddddlxxxxldxllxxldddlxlxdllddlxxlxlldlllddxllllldxldxldxxxdldxxlxxddllllxdllllllldladdllxdlllxxlddlxxlxlxllxxdlldxladxddldxxadldldllddlxxllldlldllxdddxdxxdxldddlxlldxllllxlxlldlddallddldxdxxlllllllllxxlddlxxlxlxllxxdlldxladxddldxxadldldlxladxdxdadldlxxdxadladdllxxxddllldllxdldlddxdlllxlxllxldadlddxldldxadlxxadxlllxlllldlxallldxxldxlxlldxlxlldllldxlxdldlxldllldlldxddxadlddxdllxxdllxlddlldxxxxxxxddlxdlldlxdxdxlddldlalxldxxlddxdlxllxadadlldlxllllxdxxddlxxlldxxdllxllxxldxxllxllllxxxdlldlxlxlxlxlalxldllxxdxllldxadlldallxxdlxadxdadlldlllxlxldaxlalldxllxdddxllxdllllddldxxllxdlddllllldxadxxlxddxlllxdxldlxldllxdxddxaxxxlxxlxxdlldladdllddxdldlxlxlxdddxldxxdxdxllxdxlladxlldxdlldllllalllddldlxxdlllxallllllxdddldxdldlxxdxaxddaxddxdxxxlldlllxlxadlddalxdddxxxxxlddalddlddxxalddlllldlxxdladxllllddxldxlddllldlxxlxdxx
```

This is interesting! All the subtexts consist of only 4 characters. And we can see that some
of the subtexts only consist of the letters mapped in the `remap`-function. Let's try the
function:
```bash
> python3 remap.py
msaasaaaaspssmsaaamsmmmsmmapsmmasaaaassammmasmmammsammasmmasmasmamsasamaaaamaamasmassamaassmaaampaaasmaamsmmaaammapssssasammsmasaasaasmspaaaasamasaaaasmasampmmmamaaassmsamaamsmmapamamsaaamsassasspssamampmmasamaamasmasmassmmamaspmapaasmaamsssmaamasmaaaamamaamaassaaammaapaasmssaaaaasmsamsspaapsmmasmmaasasmapsmsmpsmssmsaamsmsaaaaamamaaamaamapssamsmssasmasammssmaaaamaamapsapssaammasasmsammsmaaasssaamapmamsmasaammsaspmmaaaaammsmsmsssamsmmaaasmmammaamassmapassmpamasmmaampasmaammsmasmmsaasasammasasasmassaaaaammmamsamammsasasmasamammmssamapsasssasasmmsmaaaaasmpsmmaaamaamamamsammpsasspamsssasmsmpsaasssamspaaassaasmsamamsamammsasasmasamammmssamapsasssasasmmssspmmsmsamaamamasassaaaamssapsmamaaapsmmaamassaassmmmmasammaaamsamsamaasaaamsasmmmpsmsmasmassmaamsaamssamassapsmmpsassmmaaspaamaamasmaaaapsaaamaaaammmsasaamsaaapammasmamasammaammssssmmaaamaapsmmmasasmmmmsassassaamaaasmssmsmmamsaaassmsasasmsssmsammamaamsssmmmssssaamamasssaamsamsassssmasmsaamsamaaasaasasassmssmamssmaapaammmasaspmmasmmmaasapamsssmmsmaasmaaaaaasmmmpsmammmaamaaassmsmaasaaasmassaasaaammsamaaammmpaammasammmsaspsmssaaasaaammpaaassmsmapsamamammasssasasmsmaamaamsmaammsssaasmmammmssmapsssmsasaaaassammpsmaasmaassapmpmasssapsmsmpssaassammasaapsmpaaaassamaassaaasm
- .. .... /  - ...- --- --./ --. ....  .---. --.-- .--. --. -. -.- . .-....-..-. -.  .-..  -...-/... -..- --...--./    . .-- -. .. .. - /.... .-. .... -. .-/---.-...  - .-..- --./.-.- ...- .  .  /  .-.-/--. .-..-. -. -.  --.-. /-./.. -..-   -..-. -....-.-..-..  ...--../.. -  ..... - .-  /../ --. --.. . -./ - -/ -  - ..- - .....-.-...-..-./  .- -  . -. .--  -....-..-./ ./  ..--. . - .-- -...   ..-./-.- -. ..-- . /--.....-- - -   .- --... --.--..-.  -./.  -/.-. --..-/. -..-- -. -- .. . .--. . . -.  .....---.- .-.-- . . -. .-.---  .-./ .   . . -- -..... -/ --...-..-.-.- .--/ .  /.-   . - -/ ..   .- /...  .. - .-.- .-.-- . . -. .-.---  .-./ .   . . --   /-- - .-..-.-. .  ....-  ./ -.-.../ --..-.  ..  ----. .--...- .- .-.. ...- . ---/ - -. -.  -..- ..-  .-.  ./ --/ .  --.. /..-..-. -..../ ...-....--- . ..- .../.--. -.-. .--..--    --...-../ ---. . ---- .  .  ..-... -  - --.- ...  - . . -   - .--.-..-   ---    ..-.-.   ..- .- .    -. - ..- .-... .. . .  -  -.-  -../..---. . /--. ---.. ./.-   -- -.. -...... ---/ -.---..-...  - -.. ... -.  .. ...-- .-...---/..--. .--- . / -  ... ...--/...  - -./ .-.-.--.   . . - -..-..- -..--   .. --.---  -./   - . ....  .--/ -.. -..  ./-/-.   ./ - -/  ..  .--. ../ -/....  .-..  ... -
```
What we did here was to put one of the columns, that we created earlier by
splitting the cipher text on keyword length, into the `def remap(msg):`
function. We chose a column with the four letters `amsp` because the remap
function only maps those, as we can see by inspecting the function. The reason
the result is interesting is that a) it looks like morse code, and b) the
column we chose probably used an unshifted alphabet. Because of `b)` we can
with some certainty assume that the letter in the key for that position is `a`.

The other columns does, however, look shifted, so the key must have other
letters than `a` for those positions. The reason we used Kasiski examination
earlier was to find groups of letters, or columns, that share alphabet because
that lets us use frequency analysis on the columns. Let's do that now:
```bash
> python3 char_count.py
msaasaaaaspssmsaaamsmmmsmmapsmmasaaaassammmasmmammsammasmmasmasmamsasamaaaamaamasmassamaassmaaampaaasmaamsmmaaammapssssasammsmasaasaasmspaaaasamasaaaasmasampmmmamaaassmsamaamsmmapamamsaaamsassasspssamampmmasamaamasmasmassmmamaspmapaasmaamsssmaamasmaaaamamaamaassaaammaapaasmssaaaaasmsamsspaapsmmasmmaasasmapsmsmpsmssmsaamsmsaaaaamamaaamaamapssamsmssasmasammssmaaaamaamapsapssaammasasmsammsmaaasssaamapmamsmasaammsaspmmaaaaammsmsmsssamsmmaaasmmammaamassmapassmpamasmmaampasmaammsmasmmsaasasammasasasmassaaaaammmamsamammsasasmasamammmssamapsasssasasmmsmaaaaasmpsmmaaamaamamamsammpsasspamsssasmsmpsaasssamspaaassaasmsamamsamammsasasmasamammmssamapsasssasasmmssspmmsmsamaamamasassaaaamssapsmamaaapsmmaamassaassmmmmasammaaamsamsamaasaaamsasmmmpsmsmasmassmaamsaamssamassapsmmpsassmmaaspaamaamasmaaaapsaaamaaaammmsasaamsaaapammasmamasammaammssssmmaaamaapsmmmasasmmmmsassassaamaaasmssmsmmamsaaassmsasasmsssmsammamaamsssmmmssssaamamasssaamsamsassssmasmsaamsamaaasaasasassmssmamssmaapaammmasaspmmasmmmaasapamsssmmsmaasmaaaaaasmmmpsmammmaamaaassmsmaasaaasmassaasaaammsamaaammmpaammasammmsaspsmssaaasaaammpaaassmsmapsamamammasssasasmsmaamaamsmaammsssaasmmammmssmapsssmsasaaaassammpsmaasmaassapmpmasssapsmsmpssaassammasaapsmpaaaassamaassaaasm
{'m': 349, 's': 346, 'a': 477, 'p': 57}
```
This is probably the frequency for the clear text, so by finding the frequency of all the
subtexts and comparing it to this, we can find the shift and thus the keyword.
```
eseeseshkseesehseskkkesskhksesssssekhkeeseeesseksssksskksskksesseskskssshskkskeekehesekksskeksksesksssseheehkekessssskseeskekekskkksseekssheeekeeeeekkskhkeseeesshesskeesshskeskhseekeseskskkekesskssskeskehkksskkeksksesesekkkeekkseesskeekssesseeskkkseekkhskssksekeskeseeseeekkhkeekskssssskkksssessssseeskkseesesesseeksskeshkekkskeehkskskessskkskkkkekksseeskekkksksskessskkeeeekeshkekeseeskkkeheeekesehssssksehkekkeessssskshsskskekeekeeskehesskkkekkssekskkekeksesskkseksskeskkeesssehssekshssseseekskeeekskksskksskeskkkssskekeeseessssseskkseseeeskksssehkeehkskkesekkekksehskeksskseseeksesekssskeksseksekeehssekskeeksekekeskkkssskekeeseessssseskkseseeeskksssehkssksesehksksskssskssksskkseesesskekskseskhesheeskkkeekseksksesssssskssskksekkeksseseeekksehssehesksseeseekssskseksseskkkeskesksskesskeshssekkeesskesshkehkeekseeesskskehkkhsesksesskkessssskssssekkeskskhkksessekksskssskskseeseekksksskehekkkssesskkssksesssesekkkksseekeekeskkssskskeekekseeeskesekskkesessessskekkekeesekssskkeeekskeesshekkekseseekssesskskseeesskkksskesekseeekskssskekkksseeeeekskkseeksekhkeksksksssskksesekeessssekkkeekeekekssksekkksksesskeehksseksseeeessshksssehkksekkeeekesekeskekkessekssksesskessseekesssehkessssesekseskeseskksekkssseeeseeeesseeessssskskess
{'e': 359, 's': 466, 'h': 49, 'k': 355}
```
`p` and `h` have the lowest frequency in both subtexts, so this is probably the same character in
the cleartext. To get from `p` to `h` we have to shift 18 places in the alphabet. The character
shifting 18 is `s` (remember that `a` is 0). Do this for all the subtexts, and you will get:
```
social
```
We have a keyword!

Running the stolen code gives us:
```bash
> python3 stolen.py
-- .- .-.. .-.. . - / .... . .-. -... ... / -... .- ... .. .-.. / -. . ... - --..-- / .. -. / .-- . .-.. -.. .. -. --. / . --.- ..- .. .--. -- . -. - / .--. . -. ... / --.- ..- .- .. .-.. .-.-.- / -... ..- .-.. .-.. / -... --- .-- . .-.. ... / -.-. .- - / -.-. .... .. -.-. -.- . -. / -.-. --- .-- --..-- / -.-. .- .-.. ..-. / -.. --- -. -.- . -.-- / -.. ..- -.-. -.- .-.-.- / ..-. --- .-. .- --. . / .... .- .-. ...- . ... - . .-. / .-. .- -.- . ... / .--. . .- -.-. --- -.-. -.- ... --..-- / ... --.- ..- . .- .-.. / --. .- .-. -.. . -. / .-- --- --- ..-. .-.-.- / -.-. --- --- / .-- .. - .... / .-. .- -... -... .. - ... / . -.-. - .-.-.- / -.-. .- ..- .-.. .. ..-. .-.. --- .-- . .-. / .- / ... . . -.. ... / --.- ..- .- .. .-.. .-.-.- / -- --- --- --- / -.-. .- - / -.. .- .. ... -.-- ... --..-- / --. .-. ..- -. - / .. -. / - ..- .-. -.- . -.-- / -.-. --- --- --..-- / .-- .. -. -.. -- .. .-.. .-.. / .- - / -... ..- .-.. .-.. .-.-.- / --. --- ..- .-. -.. ... / ..- - - . .-. ... / .- - / .-- . .-.. -.. .. -. --. / . --.- ..- .. .--. -- . -. - / .- / --- .. -. -.- / --- .. -. -.- / .... .- -.-- -... .. -. . .-.-.- / .-. --- --- ... - . .-. / -.-. . .-.. . .-. -.-- / .--. .. -. . .- .--. .--. .-.. . .-.-.- / / ..-. . .-. - .. .-.. .. --.. . .-. --..-- / .- / -- . .-.. --- -. / -.-. .... .. .-. .--. / .--. . - ... / .. -. .-.-.- / .--. .-. .- .. .-. .. . / -.. --- --. ... / .-. .- -.-. -.-. --- --- -. ... / .-. --- -... .. -. ... / .-. .- - ... .-.-.- / --- -. .. --- -. / --- .-. --. .- -. .. -.-. / --- .-. .- -. --. . ... / .- -. -.. / .--. ..- .-. .-. / -.. ..- -.-. -.- ... / -.-. .- -. -. .. -. --. / --- .-- .-.. ... / .- - / .- / ... --.- ..- . .- .-.. .-.-.- / -.-. .- ..- .-.. .. ..-. .-.. --- .-- . .-. / .- / ... . . -.. ... / --.- ..- .- .. .-.. .-.-.- / .... --- --- - / ... --.- ..- . .- .-.. / -- --- --- ... . / --.- ..- .- -.-. -.- --..-- / -.-. .-. --- .-- ... / -.. --- --. --. .. . ... / ..-. .-. --- --. ... / -.-. .-. .. -.-. -.- . - ... / -.-. .... .. .-. .--. .-.-.- / ...- . - . .-. .. -. .- .-. .. .- -. / .- - / ... . . -.. . .-. / . --. --. ... / .-- .. - .... / .-- .- - . .-. -- . .-.. --- -. / --- ... - .-. .. -.-. .... . ... .-.-.- / ...- . - . .-. .. -. .- .-. .. .- -. / -... .-.. ..- . / -... . .-. .-. .. . ... / -.-. .- - - .-.. . / .--- . .-.. .-.. -.-- / -.-. .- -. -. .. -. --. .-.-.- / - ..- .-. -.- . -.-- / -.. .- .. ... -.-- ... / . --. --. ... / ... --.- ..- . .- .-.. --..-- / .... --- .-. ... . ... / -- --- --- -. ... .... .. -. . / .- .--. .--. .-.. . ... / .-. .- .. ... .. -. --. / -- --- --- --- / - .-. .- -.-. - --- .-. / .--. .-.. --- .-- .-.-.- / ..- - - . .-. ... / .- .-. . / .-- . .- - .... . .-. ...- .- -. . / ..-. --- .- .-.. / . ... - .-.-.- / .. -. / - .... . / ... - .-. .- .-- / .-. .- .. -. / -... .- .-. .-. . .-.. ... .-.-.- / .-.-.- / ... .- --. . / -- --- .-- . .-. / --. --- .- - .-.-.- / / .-. .- -.-. -.-. --- --- -. ... / .-. .... ..- -... .- .-. -... / --- ..- - .... --- ..- ... . / .- --..-- / .- .--. .--. .-.. . ... / -... . .-. .-. .. . ... / -.-. --- .-. -. .-.-.- / .... --- --- - / ... --.- ..- . .- .-.. / -- --- --- ... . / --.- ..- .- -.-. -.- --..-- / -.-. .-. --- .-- ... / -.. --- --. --. .. . ... / ..-. .-. --- --. ... / -.-. .-. .. -.-. -.- . - ... / -.-. .... .. .-. .--. .-.-.- / ..-. --- .-. .- --. . / .... .- .-. ...- . ... - . .-. --..-- / -... . .- -. / .- -. -.. / ... .. .-.. .- --. . / -.. ..- -- .--. --..-- / -.-. ..- .-.. - .. ...- .- - --- .-. / -... .-. ..- ... ... . .-.. / ... .--. .-. --- ..- - ... / .... .- .-. .-. --- .-- ... --..-- / -.-. . .-.. . .-. -.-- / -.. .-. . .- -.. / .-- .. - .... / -.- .- .-.. . / .- ..- --. . .-. ... / .... .- .-. .-. --- .-- ... .-.-.- / .... --- --- - / ... --.- ..- . .- .-.. / -- --- --- ... . / --.- ..- .- -.-. -.- --..-- / -.-. .-. --- .-- ... / -.. --- --. --. .. . ... / ..-. .-. --- --. ... / -.-. .-. .. -.-. -.- . - ... / -.-. .... .. .-. .--. .-.-.- / ..-. . . -.. / .. -. / .- / .-- --- --- ..-. --..-- / .- / ..-. .- .-. -- . .-. ... / -- .- .-. -.- . - .-.-.- / -... .-.. ..- . / -... . .-. .-. .. . ... / .--. .. --. . --- -. ... / -... ..- --.. --.. / .- -. -.. / -... . .- -. / .--. .-. .- .. .-. .. . / -.. --- --. ... / -. .- .. .-.. ... / .- - / . ... - .-.-.- / -.-. --- -- -... .. -. . / .... .- .-. ...- . ... - . .-. / ... .-- .- - .... . .-. --..-- / -... .- .-.. . .-. / .- ... / .... .- -.-- -... .. -. . / .--. .- .-. ... .-.. . -.-- --..-- / -- . .-.. --- -. / .. -. / .... .- .-.-.- / / .-. .- -.- . .-.-.- / . .-- . ... / -- ..- ... .... .-. --- --- -- ... / --.. ..- -.-. -.-. .... .. -. .. / .. -. / ..-. --- .-. .- --. . / .... .- .-. ...- . ... - . .-. / .- - / ... .... . . .--. / .-- .. - .... / - .-. .- -.-. - --- .-. .-.-.- / .--- --- .... -. / -.. . . .-. . / -... . . ... --..-- / .--. .- .-. ... .-.. . -.-- / ... .-- . . - / -.-. --- .-. -. / .- - --..-- / .--. --- .-. -.- -.-- / .--. .. --. / ... .... --- ...- . .-.. ... .-.-.- / .-.. .- -- -... / .. -. / . --. --. .--. .-.. .- -. - / -... .- .-.. . .-. / .-. .- .. -. / -... .- .-. .-. . .-.. ... / -- .- -. ..- .-. . / .... .- -.-- / .-. .- -.- . .-.-.- / -.-. .- - / .- - / .--. .. -. . .- .--. .--. .-.. . ... / .--. .. --. . --- -. ... .-.-.- / .--. .-. .- .. .-. .. . / -.. --- --. ... / .-. .- -.-. -.-. --- --- -. ... / .-. --- -... .. -. ... / .-. .- - ... .-.-.- / -- --- ..- ... . / ... --- -.-- -... . .- -. ... / ... .-- . . - / -.-. --- .-. -. / .... --- --. ... / .-.. .-.. .- -- .- ... / --- .-. / --- .. -. -.- / --- .. -. -.- / .-- .. -. -.. .-.-.- / .--- --- .... -. / -.. . . .-. . / -... . . ... --..-- / .--. .- .-. ... .-.. . -.-- / ... .-- . . - / -.-. --- .-. -. / .- - --..-- / .--. --- .-. -.- -.-- / .--. .. --. / ... .... --- ...- . .-.. ... .-.-.- / .--. .-. .- .. .-. .. . / -.. --- --. ... / .-. .- -.-. -.-. --- --- -. ... / .-. --- -... .. -. ... / .-. .- - ... .-.-.- / --- ..- - .... --- ..- ... . / .- - / -. .- .. .-.. ... / -- --- .-- . .-. .-.-.- / .- .--. .--. .-.. . ... / -.. ..- -.-. -.- ... / ... - .-. .- .-- --..-- / --.- ..- .- .. .-.. / .- / --- ... - .-. .. -.-. .... . ... / -.. --- -. -.- . -.-- .-.-.- / / .... .- -.-- / .... --- --- -.- / -.-. ..- -.-. ..- -- -... . .-. ... .-.-.- / .-. --- --- ... - . .-. / -.-. . .-.. . .-. -.-- / .--. .. -. . .- .--. .--. .-.. . ... / ..-. . .-. - .. .-.. .. --.. . .-. --..-- / .- / -- . .-.. --- -. / -.-. .... .. .-. .--. / .--. . - ... / .. -. .-.-.- / --. .- - . / .-- .. -. -.. --..-- / -- --- --- -. ... .... .. -. . / .... --- .-. ... . ... / -- . --- .-- / .. .-. .-. .. --. .- - .. --- -. / --..-- / .-- .. - .... / ..-. . . -.. / - .-. --- ..- --. .... ... / -.-. .... . . .--. --..-- / --- .-. / -.-. .- -... -... .- --. . / .-- .. - .... / .--. ..- -- .--. -.- .. -. / - .-. . . ... / -.-. .... .. -.-. -.- . -. .-.-.- / -... .- .- / .--. --- - .- - --- / -.. --- -. -.- . -.-- / -- --- ..- ... . --..-- / .- - / --. .- - . / --. .-. .- .. -. / -... .. -. ... / .-- --- --- ..-. .-.-.- / -... .-. ..- ... ... . .-.. / ... .--. .-. --- ..- - ... / -.-. --- .-- --..-- / .-. .- -... -... .. - ... / .- / --. .- - . ... / .- --..-- / ... - --- .-. .- --. . / ... .... . -.. / ..-. . -. -.-. . ... .-.-.- / ..-. . .-. - .. .-.. .. --.. . .-. / -... ..- --.. --.. --..-- / .--. ..- .-. .-. / -- . --- .-.-.- / -. -.-. / ...- .. --. . -. . .-. . ... .... --- ..- ... . .-.-.- - --. .... .- -.-. -.- .-.-.- -. ---
```
Using [this](http://rumkin.com/tools/cipher/morse.php) tool, we get the following text:
```
MALLET HERBS BASIL NEST, IN WELDING EQUIPMENT PENS QUAIL. BULL BOWELS CAT CHICKEN COW, CALF DONKEY DUCK. FORAGE HARVESTER RAKES PEACOCKS, SQUEAL GARDEN WOOF. COO WITH RABBITS ECT. CAULIFLOWER A SEEDS QUAIL. MOOO CAT DAISYS, GRUNT IN TURKEY COO, WINDMILL AT BULL. GOURDS UTTERS AT WELDING EQUIPMENT A OINK OINK HAYBINE. ROOSTER CELERY PINEAPPLE. FERTILIZER, A MELON CHIRP PETS IN. PRAIRIE DOGS RACCOONS ROBINS RATS. ONION ORGANIC ORANGES AND PURR DUCKS CANNING OWLS AT A SQUEAL. CAULIFLOWER A SEEDS QUAIL. HOOT SQUEAL MOOSE QUACK, CROWS DOGGIES FROGS CRICKETS CHIRP. VETERINARIAN AT SEEDER EGGS WITH WATERMELON OSTRICHES. VETERINARIAN BLUE BERRIES CATTLE JELLY CANNING. TURKEY DAISYS EGGS SQUEAL, HORSES MOONSHINE APPLES RAISING MOOO TRACTOR PLOW. UTTERS ARE WEATHERVANE FOAL EST. IN THE STRAW RAIN BARRELS. . SAGE MOWER GOAT. RACCOONS RHUBARB OUTHOUSE A, APPLES BERRIES CORN. HOOT SQUEAL MOOSE QUACK, CROWS DOGGIES FROGS CRICKETS CHIRP. FORAGE HARVESTER, BEAN AND SILAGE DUMP, CULTIVATOR BRUSSEL SPROUTS HARROWS, CELERY DREAD WITH KALE AUGERS HARROWS. HOOT SQUEAL MOOSE QUACK, CROWS DOGGIES FROGS CRICKETS CHIRP. FEED IN A WOOF, A FARMERS MARKET. BLUE BERRIES PIGEONS BUZZ AND BEAN PRAIRIE DOGS NAILS AT EST. COMBINE HARVESTER SWATHER, BALER AS HAYBINE PARSLEY, MELON IN HA. RAKE. EWES MUSHROOMS ZUCCHINI IN FORAGE HARVESTER AT SHEEP WITH TRACTOR. JOHN DEERE BEES, PARSLEY SWEET CORN AT, PORKY PIG SHOVELS. LAMB IN EGGPLANT BALER RAIN BARRELS MANURE HAY RAKE. CAT AT PINEAPPLES PIGEONS. PRAIRIE DOGS RACCOONS ROBINS RATS. MOUSE SOYBEANS SWEET CORN HOGS LLAMAS OR OINK OINK WIND. JOHN DEERE BEES, PARSLEY SWEET CORN AT, PORKY PIG SHOVELS. PRAIRIE DOGS RACCOONS ROBINS RATS. OUTHOUSE AT NAILS MOWER. APPLES DUCKS STRAW, QUAIL A OSTRICHES DONKEY. HAY HOOK CUCUMBERS. ROOSTER CELERY PINEAPPLES FERTILIZER, A MELON CHIRP PETS IN. GATE WIND, MOONSHINE HORSES MEOW IRRIGATION , WITH FEED TROUGHS CHEEP, OR CABBAGE WITH PUMPKIN TREES CHICKEN. BAA POTATO DONKEY MOUSE, AT GATE GRAIN BINS WOOF. BRUSSEL SPROUTS COW, RABBITS A GATES A, STORAGE SHED FENCES. FERTILIZER BUZZ, PURR MEO. NC VIGENERESHOUSE.TGHACK.NO
```
At the end it says to `nc vigenereshouse.tghack.no`. We can do just that, but we need a port.
The port is in the task-description as a python [anonymous/lambda-function](https://docs.python.org/3/tutorial/controlflow.html#lambda-expressions).
With the lambda we can do [functional programming](https://en.wikipedia.org/wiki/Functional_programming) in python.
Type `python` in a terminal and paste the function:
```python
>>> filter(lambda p: all(p % n for n in range(3, int(__import__("math").sqrt(p)) + 1, 2)), range(3, 10000, 2))[893]+2
6969
```
```bash
> nc vignereshouse.tghack.no 6969
TG18\{ egcialkooamlkacusakacumdeaoaalegramlsouimdeocisxsocaaxkaoisl/}
```
Seems like the flag is also encrypted. Let's try to decrypt it with the same key:
```bash
> python3 stolen.py
- .... .- -. -.- / -.-- --- ..- / -... .- -... -... .- --. .
```
Decoding morse gives us:
```
THANK YOU BABBAGE
```
The flag is:
```
TG18{thank you babbage}
```
